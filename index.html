<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/blog/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/blog/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/blog/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, Frank" />








  <link rel="shortcut icon" type="image/x-icon" href="/blog/favicon.ico?v=0.5.0" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Under the Wood">
<meta property="og:url" content="http://www.biofrank.com/index.html">
<meta property="og:site_name" content="Under the Wood">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Under the Wood">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>

  <title> Under the Wood </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/blog/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Under the Wood</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/blog/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/blog/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/blog/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            Tags
          </a>
        </li>
      

      
      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">

    

    
    

    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/blog/2016/03/10/GCD-4/" itemprop="url">
                  Getting and Cleaning Data: Quiz 4
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-03-10T16:58:29+08:00" content="2016-03-10">
              2016-03-10
            </time>
          </span>

          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Quiz"><a href="#Quiz" class="headerlink" title="Quiz"></a>Quiz</h3><ol>
<li><p>The American Community Survey distributes downloadable data about United States communities. Download the 2006 microdata survey about housing for the state of Idaho using download.file() from here:</p>
<p><a href="https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06hid.csv" target="_blank" rel="external">https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06hid.csv</a></p>
<p>and load the data into R. The code book, describing the variable names is here:</p>
<p><a href="https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FPUMSDataDict06.pdf" target="_blank" rel="external">https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FPUMSDataDict06.pdf</a></p>
<p>Apply strsplit() to split all the names of the data frame on the characters “wgtp”. What is the value of the 123 element of the resulting list?</p>
<ul>
<li>“15”</li>
<li>“w” “15”</li>
<li>“” “15”</li>
<li>“wgtp” “15”<br>​</li>
</ul>
</li>
<li><p>Load the Gross Domestic Product data for the 190 ranked countries in this data set:</p>
<p><a href="https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FGDP.csv" target="_blank" rel="external">https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FGDP.csv</a></p>
<p>Remove the commas from the GDP numbers in millions of dollars and average them. What is the average?</p>
<p>Original data sources:</p>
<p><a href="http://data.worldbank.org/data-catalog/GDP-ranking-table" target="_blank" rel="external">http://data.worldbank.org/data-catalog/GDP-ranking-table</a></p>
<ul>
<li>377652.4</li>
<li>293700.3</li>
<li>387854.4</li>
<li>381668.9<br>​</li>
</ul>
</li>
<li><p>In the data set from Question 2 what is a regular expression that would allow you to count the number of countries whose name begins with “United”? Assume that the variable with the country names in it is named countryNames. How many countries begin with United?</p>
<ul>
<li>grep(“^United”,countryNames), 3</li>
<li>grep(“^United”,countryNames), 4</li>
<li>grep(“*United”,countryNames), 2</li>
<li>grep(“United$”,countryNames), 3<br>​</li>
</ul>
</li>
<li><p>Load the Gross Domestic Product data for the 190 ranked countries in this data set:</p>
<p><a href="https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FGDP.csv" target="_blank" rel="external">https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FGDP.csv</a></p>
<p>Load the educational data from this data set:</p>
<p><a href="https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FEDSTATS_Country.csv" target="_blank" rel="external">https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FEDSTATS_Country.csv</a></p>
<p>Match the data based on the country shortcode. Of the countries for which the end of the fiscal year is available, how many end in June?</p>
<p>Original data sources:</p>
<p><a href="http://data.worldbank.org/data-catalog/GDP-ranking-table" target="_blank" rel="external">http://data.worldbank.org/data-catalog/GDP-ranking-table</a></p>
<p><a href="http://data.worldbank.org/data-catalog/ed-stats" target="_blank" rel="external">http://data.worldbank.org/data-catalog/ed-stats</a></p>
<ul>
<li>31</li>
<li>13</li>
<li>8</li>
<li>15<br>​</li>
</ul>
</li>
<li><p>You can use the quantmod (<a href="http://www.quantmod.com/" target="_blank" rel="external">http://www.quantmod.com/</a>) package to get historical stock prices for publicly traded companies on the NASDAQ and NYSE. Use the following code to download data on Amazon’s stock price and get the times the data was sampled.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(quantmod)</span><br><span class="line">amzn = getSymbols(<span class="string">"AMZN"</span>,auto.assign=<span class="literal">FALSE</span>)</span><br><span class="line">sampleTimes = index(amzn)</span><br></pre></td></tr></table></figure>
<p>How many values were collected in 2012? How many values were collected on Mondays in 2012?</p>
<ul>
<li>251, 47</li>
<li>250, 47</li>
<li>252, 47</li>
<li>252, 50</li>
</ul>
</li>
</ol>
<h3 id="My-solution"><a href="#My-solution" class="headerlink" title="My solution"></a>My solution</h3><ol>
<li><p>Download the file from the Internet, use browser or commands:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fileUrl &lt;- <span class="string">"https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06hid.csv"</span></span><br><span class="line">download.file(fileUrl, destfile = <span class="string">"hid.csv"</span>, method = <span class="string">"curl"</span>)</span><br></pre></td></tr></table></figure>
<p>analysis the data:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">housingdata &lt;- read.csv(<span class="string">"hid.csv"</span>)</span><br><span class="line">list &lt;- strsplit(names(housingdata), split = <span class="string">"wgtp"</span>)</span><br><span class="line">list[<span class="number">123</span>]</span><br></pre></td></tr></table></figure>
<p>the result is <code>&quot;&quot;, &quot;15&quot;</code>.</p>
</li>
<li><p>Download the file from the Internet, use browser or commands:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fileUrl &lt;- <span class="string">"https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FGDP.csv"</span></span><br><span class="line">download.file(fileUrl, destfile = <span class="string">"GDP.csv"</span>, method = <span class="string">"curl"</span>)</span><br><span class="line">gdp &lt;- read.csv(<span class="string">"GDP.csv"</span>, skip = <span class="number">4</span>, nrows = <span class="number">190</span>)</span><br><span class="line">view(gdp)</span><br></pre></td></tr></table></figure>
<p>analysis the data:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cleanData &lt;- gsub(<span class="string">","</span>, <span class="string">""</span>, gdp$X.4)</span><br><span class="line">cleanData &lt;- (as.numeric(cleanData))</span><br><span class="line">mean(cleanData, na.rm = <span class="literal">TRUE</span>)</span><br></pre></td></tr></table></figure>
<p>the result is <code>377652.4</code>.</p>
</li>
<li><p>Analysis the data with the command line:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">countryNames &lt;- gdp$X.3</span><br><span class="line">grep(<span class="string">"^United"</span>,countryNames)</span><br></pre></td></tr></table></figure>
<p>shows:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>]  <span class="number">1</span>  <span class="number">6</span> <span class="number">32</span></span><br><span class="line">Warning messages:</span><br><span class="line"><span class="number">1</span>: In grep(<span class="string">"^United"</span>, countryNames) :</span><br><span class="line">  input string <span class="number">99</span> is invalid <span class="keyword">in</span> this locale</span><br><span class="line"><span class="number">2</span>: In grep(<span class="string">"^United"</span>, countryNames) :</span><br><span class="line">  input string <span class="number">186</span> is invalid <span class="keyword">in</span> this locale</span><br></pre></td></tr></table></figure>
<p>the answer is <code>grep(&quot;^United&quot;,countryNames), 3</code>.</p>
</li>
<li><p>Download the file from the Internet, use browser or commands:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fileUrl1 &lt;- <span class="string">"https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FGDP.csv"</span></span><br><span class="line">fileUrl2 &lt;- <span class="string">"https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FEDSTATS_Country.csv"</span></span><br><span class="line">download.file(fileUrl1, destfile = <span class="string">"GDP.csv"</span>, method = <span class="string">"curl"</span>)</span><br><span class="line">download.file(fileUrl2, destfile = <span class="string">"edu.csv"</span>, method = <span class="string">"curl"</span>)</span><br></pre></td></tr></table></figure>
<p>analysis the data:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">gdpdata &lt;- read.csv(<span class="string">"GDP.csv"</span>, skip = <span class="number">4</span>, nrows = <span class="number">190</span>)</span><br><span class="line">edudata &lt;- read.csv(<span class="string">"edu.csv"</span>)</span><br><span class="line">View(gdpdata)</span><br><span class="line">View(edudata)</span><br><span class="line">mergeData &lt;- merge(gdpdata, edudata, by.x = <span class="string">"X"</span>, by.y = <span class="string">"CountryCode"</span>)</span><br><span class="line">View(mergeData)</span><br><span class="line">june &lt;- grep(<span class="string">'Fiscal year end: June'</span>, mergeData$Special.Notes)</span><br><span class="line">length(june)</span><br></pre></td></tr></table></figure>
<p>the result is <code>13</code>.</p>
</li>
<li><p>Install the package quantmod:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">install.packages(<span class="string">"quantmod"</span>)</span><br></pre></td></tr></table></figure>
<p>Use the following code to download data on Amazon’s stock price and get the times the data was sampled:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(quantmod)</span><br><span class="line">amzn = getSymbols(<span class="string">"AMZN"</span>,auto.assign=<span class="literal">FALSE</span>)</span><br><span class="line">sampleTimes = index(amzn)</span><br></pre></td></tr></table></figure>
<p>analysis the data:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">year2012 &lt;- grepl(<span class="string">'2012-*'</span>, sampleTimes)</span><br><span class="line">sampleTimes2012 &lt;- subset(sampleTimes, year2012)</span><br><span class="line">day &lt;- format(sampleTimes2012, <span class="string">'%A'</span>)</span><br><span class="line">table(year2012)</span><br></pre></td></tr></table></figure>
<p>it shows:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">year2012</span><br><span class="line"><span class="literal">FALSE</span>  <span class="literal">TRUE</span> </span><br><span class="line"> <span class="number">2063</span>   <span class="number">250</span></span><br></pre></td></tr></table></figure>
<p>then:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">table(day)</span><br></pre></td></tr></table></figure>
<p>is shows:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">day</span><br><span class="line">   Friday    Monday  Thursday   Tuesday Wednesday </span><br><span class="line">       <span class="number">51</span>        <span class="number">47</span>        <span class="number">51</span>        <span class="number">50</span>        <span class="number">51</span></span><br></pre></td></tr></table></figure>
<p>the result is <code>250, 47</code>.</p>
<p>​<br>The END.</p>
</li>
</ol>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/blog/2016/03/09/GCD-3/" itemprop="url">
                  Getting and Cleaning Data: Quiz 3
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-03-09T15:34:48+08:00" content="2016-03-09">
              2016-03-09
            </time>
          </span>

          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Quiz"><a href="#Quiz" class="headerlink" title="Quiz"></a>Quiz</h3><ol>
<li><p>The American Community Survey distributes downloadable data about United States communities. Download the 2006 microdata survey about housing for the state of Idaho using download.file() from here:</p>
<p><a href="https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06hid.csv" target="_blank" rel="external">https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06hid.csv</a></p>
<p>and load the data into R. The code book, describing the variable names is here:</p>
<p><a href="https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FPUMSDataDict06.pdf" target="_blank" rel="external">https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FPUMSDataDict06.pdf</a></p>
<p>Create a logical vector that identifies the households on greater than 10 acres who sold more than $10,000 worth of agriculture products. Assign that logical vector to the variable agricultureLogical. Apply the which() function like this to identify the rows of the data frame where the logical vector is TRUE.</p>
<p>which(agricultureLogical)</p>
<p>What are the first 3 values that result?</p>
<ul>
<li>125, 238,262</li>
<li>25, 36, 45</li>
<li>59, 460, 474</li>
<li>403, 756, 798<br>​</li>
</ul>
</li>
<li><p>Using the jpeg package read in the following picture of your instructor into R</p>
<p><a href="https://d396qusza40orc.cloudfront.net/getdata%2Fjeff.jpg" target="_blank" rel="external">https://d396qusza40orc.cloudfront.net/getdata%2Fjeff.jpg</a></p>
<p>Use the parameter native=TRUE. What are the 30th and 80th quantiles of the resulting data? (some Linux systems may produce an answer 638 different for the 30th quantile)</p>
<ul>
<li>10904118 -594524</li>
<li>-15259150 -10575416</li>
<li>-10904118 -10575416</li>
<li>-16776430 -15390165<br>​</li>
</ul>
</li>
<li><p>Load the Gross Domestic Product data for the 190 ranked countries in this data set:</p>
<p><a href="https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FGDP.csv" target="_blank" rel="external">https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FGDP.csv</a></p>
<p>Load the educational data from this data set:</p>
<p><a href="https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FEDSTATS_Country.csv" target="_blank" rel="external">https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FEDSTATS_Country.csv</a></p>
<p>Match the data based on the country shortcode. How many of the IDs match? Sort the data frame in descending order by GDP rank (so United States is last). What is the 13th country in the resulting data frame?</p>
<p>Original data sources:</p>
<p><a href="http://data.worldbank.org/data-catalog/GDP-ranking-table" target="_blank" rel="external">http://data.worldbank.org/data-catalog/GDP-ranking-table</a></p>
<p><a href="http://data.worldbank.org/data-catalog/ed-stats" target="_blank" rel="external">http://data.worldbank.org/data-catalog/ed-stats</a></p>
<ul>
<li>190 matches, 13th country is St. Kitts and Nevis</li>
<li>190 matches, 13th country is Spain</li>
<li>189 matches, 13th country is Spain</li>
<li>189 matches, 13th country is St. Kitts and Nevis</li>
<li>234 matches, 13th country is Spain</li>
<li>234 matches, 13th country is St. Kitts and Nevis<br>​</li>
</ul>
</li>
<li><p>What is the average GDP ranking for the “High income: OECD” and “High income: nonOECD” group?</p>
<ul>
<li>23, 45</li>
<li>23.966667, 30.91304</li>
<li>133.72973, 32.96667</li>
<li>32.96667, 91.91304</li>
<li>23, 30</li>
<li>30, 37<br>​</li>
</ul>
</li>
<li><p>Cut the GDP ranking into 5 separate quantile groups. Make a table versus Income.Group. How many countries are Lower middle income but among the 38 nations with highest GDP?</p>
<ul>
<li>5</li>
<li>13</li>
<li>12</li>
<li>0</li>
</ul>
</li>
</ol>
<h3 id="My-solution"><a href="#My-solution" class="headerlink" title="My solution"></a>My solution</h3><ol>
<li><p>Download the file from the Internet, use browser or commands:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fileUrl &lt;- <span class="string">"https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06hid.csv"</span></span><br><span class="line">download.file(url = fileUrl, destfile = <span class="string">"getdata.csv"</span>, method = <span class="string">"curl"</span>)</span><br><span class="line">data &lt;- read.table(<span class="string">"getdata.csv"</span>, header = <span class="literal">TRUE</span>, sep = <span class="string">","</span>)</span><br><span class="line">head(data)</span><br></pre></td></tr></table></figure>
<p>then analysis the data:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">agricultureLogical &lt;- data$ACR == <span class="number">3</span> &amp; data$AGS ==<span class="number">6</span></span><br><span class="line">head(which(agricultureLogical), <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>the result is <code>125 238 262</code>.</p>
</li>
<li><p>After install the “jpeg” package of R, download the file from the Internet, use command line:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(jpeg)</span><br><span class="line">fileUrl &lt;- <span class="string">"https://d396qusza40orc.cloudfront.net/getdata%2Fjeff.jpg"</span></span><br><span class="line">download.file(url = fileUrl, destfile = <span class="string">"jeff.jpg"</span>, method = <span class="string">"curl"</span>)</span><br><span class="line">jpg &lt;- readJPEG(<span class="string">"jeff.jpg"</span>, native = <span class="literal">TRUE</span>)</span><br><span class="line">quantile(jpg, probs = c(<span class="number">0.3</span>, <span class="number">0.8</span>))</span><br></pre></td></tr></table></figure>
<p>the result is <code>-15259150 -10575416</code>.</p>
</li>
<li><p>Download the file from the Internet, use command line:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fileUrl1 &lt;- <span class="string">"https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FGDP.csv"</span></span><br><span class="line">fileUrl2 &lt;- <span class="string">"https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FEDSTATS_Country.csv"</span></span><br><span class="line">download.file(fileUrl1, destfile = <span class="string">"GDP.csv"</span>, method = <span class="string">"curl"</span>)</span><br><span class="line">download.file(fileUrl2, destfile = <span class="string">"country.csv"</span>, method = <span class="string">"curl"</span>)</span><br></pre></td></tr></table></figure>
<p>load the file:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gdp &lt;- read.csv(<span class="string">"FGDP.csv"</span>, header = <span class="literal">TRUE</span>, skip = <span class="number">3</span>, sep = <span class="string">","</span>)</span><br><span class="line">edu &lt;- read.csv(<span class="string">"country.csv"</span>, header = <span class="literal">TRUE</span>)</span><br></pre></td></tr></table></figure>
<p>analysis the data:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(data.table)</span><br><span class="line"><span class="keyword">library</span>(dplyr)</span><br><span class="line">gdp &lt;- fread(<span class="string">"GDP.csv"</span>, skip = <span class="number">4</span>, nrows = <span class="number">190</span>, select = c(<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>), col.names = c(<span class="string">"CountryCode"</span>, <span class="string">"Rank"</span>, <span class="string">"Economy"</span>, <span class="string">"Total"</span>))</span><br><span class="line">edu &lt;- fread(<span class="string">"country.csv"</span>)</span><br><span class="line">View(gdp)</span><br><span class="line">View(edu)</span><br><span class="line">merge &lt;- merge(gdp, edu, by = <span class="string">'CountryCode'</span>)</span><br></pre></td></tr></table></figure>
<p>show the result:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nrow(merge)</span><br></pre></td></tr></table></figure>
<p>result is <code>189</code>.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arrange(merge, desc(Rank))[<span class="number">13</span>, Economy]</span><br></pre></td></tr></table></figure>
<p>result is <code>&quot;St. Kitts and Nevis&quot;</code>.</p>
</li>
<li><p>analysis with the command line:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tapply(merge$Rank, merge$`Income Group`, mean)</span><br></pre></td></tr></table></figure>
<p>shows:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">High income: nonOECD    High income: OECD           Low income  Lower middle income </span><br><span class="line">            <span class="number">91.91304</span>             <span class="number">32.96667</span>            <span class="number">133.72973</span>            <span class="number">107.70370</span> </span><br><span class="line"> Upper middle income </span><br><span class="line">            <span class="number">92.13333</span></span><br></pre></td></tr></table></figure>
<p>the result is <code>32.96667 91.91304</code>.</p>
</li>
<li><p>analysis with the command line:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">merge$RankGroups &lt;- cut(merge$Rank, breaks = <span class="number">5</span>)</span><br><span class="line">table(merge$RankGroups, merge$`Income Group`)</span><br></pre></td></tr></table></figure>
<p>the result is <code>5</code>.</p>
</li>
</ol>
<p>The END.</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/blog/2016/03/04/GCD-2/" itemprop="url">
                  Getting and Cleaning Data: Quiz 2
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-03-04T18:40:41+08:00" content="2016-03-04">
              2016-03-04
            </time>
          </span>

          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Quiz"><a href="#Quiz" class="headerlink" title="Quiz"></a>Quiz</h3><ol>
<li><p>Register an application with the Github API here <a href="https://github.com/settings/applications" target="_blank" rel="external">https://github.com/settings/applications</a>. Access the API to get information on your instructors repositories (hint: this is the url you want “<a href="https://api.github.com/users/jtleek/repos" target="_blank" rel="external">https://api.github.com/users/jtleek/repos</a>“). Use this data to find the time that the datasharing repo was created. What time was it created?</p>
<p>This tutorial may be useful (<a href="https://github.com/hadley/httr/blob/master/demo/oauth2-github.r" target="_blank" rel="external">https://github.com/hadley/httr/blob/master/demo/oauth2-github.r</a>). You may also need to run the code in the base R package and not R studio.</p>
<ul>
<li>2012-06-20T18:39:06Z</li>
<li>2013-08-28T18:18:50Z</li>
<li>2013-11-07T13:25:07Z</li>
<li>2012-06-21T17:28:38Z<br>​</li>
</ul>
</li>
<li><p>The sqldf package allows for execution of SQL commands on R data frames. We will use the sqldf package to practice the queries we might send with the dbSendQuery command in RMySQL.</p>
<p>Download the American Community Survey data and load it into an R object called</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acs</span><br></pre></td></tr></table></figure>
<p><a href="https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06pid.csv" target="_blank" rel="external">https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06pid.csv</a></p>
<p>Which of the following commands will select only the data for the probability weights pwgtp1 with ages less than 50?</p>
<ul>
<li>sqldf(“select pwgtp1 from acs where AGEP &lt; 50”)</li>
<li>sqldf(“select * from acs”)</li>
<li>sqldf(“select pwgtp1 from acs”)</li>
<li>sqldf(“select * from acs where AGEP &lt; 50”)<br>​</li>
</ul>
</li>
<li><p>Using the same data frame you created in the previous problem, what is the equivalent function to unique(acs$AGEP)</p>
<ul>
<li>sqldf(“select distinct pwgtp1 from acs”)</li>
<li>sqldf(“select unique AGEP from acs”)</li>
<li>sqldf(“select AGEP where unique from acs”)</li>
<li>sqldf(“select distinct AGEP from acs”)<br>​</li>
</ul>
</li>
<li><p>How many characters are in the 10th, 20th, 30th and 100th lines of HTML from this page:</p>
<p><a href="http://biostat.jhsph.edu/~jleek/contact.html" target="_blank" rel="external">http://biostat.jhsph.edu/~jleek/contact.html</a></p>
<p>(Hint: the nchar() function in R may be helpful)</p>
<ul>
<li>45 0 2 2</li>
<li>45 31 2 25</li>
<li>45 92 7 2</li>
<li>43 99 7 25</li>
<li>45 31 7 31</li>
<li>45 31 7 25</li>
<li>43 99 8 6<br>​</li>
</ul>
</li>
<li><p>Read this data set into R and report the sum of the numbers in the fourth of the nine columns.</p>
<p><a href="https://d396qusza40orc.cloudfront.net/getdata%2Fwksst8110.for" target="_blank" rel="external">https://d396qusza40orc.cloudfront.net/getdata%2Fwksst8110.for</a></p>
<p>Original source of the data: <a href="http://www.cpc.ncep.noaa.gov/data/indices/wksst8110.for" target="_blank" rel="external">http://www.cpc.ncep.noaa.gov/data/indices/wksst8110.for</a></p>
<p>(Hint this is a fixed width file format)</p>
<ul>
<li><p>36.5</p>
</li>
<li><p>35824.9</p>
</li>
<li><p>32426.7</p>
</li>
<li><p>222243.1</p>
</li>
<li><p>101.83</p>
</li>
<li><p>28893.3</p>
</li>
</ul>
</li>
</ol>
<h3 id="My-Solution"><a href="#My-Solution" class="headerlink" title="My Solution"></a>My Solution</h3><ol>
<li><p>Load library and require the package:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(httr)</span><br><span class="line"><span class="keyword">require</span>(httpuv)</span><br><span class="line"><span class="keyword">require</span>(jsonlite)</span><br></pre></td></tr></table></figure>
<p>setting the OAuth for github:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oauth_endpoints(<span class="string">"github"</span>)</span><br></pre></td></tr></table></figure>
<p>after register an application through <a href="https://github.com/settings/applications" target="_blank" rel="external">https://github.com/settings/applications</a></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">myapp &lt;- oauth_app(<span class="string">"quiz2"</span>, </span><br><span class="line">                   key = <span class="string">"b87a2841e89ce55fe15e"</span>, </span><br><span class="line">                   secret = <span class="string">"b1d4ede3d6f11878f51d0a842e3aa4c219b59c27"</span>)</span><br></pre></td></tr></table></figure>
<p>get OAuth credentials:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">github_token &lt;- oauth2.0_token(oauth_endpoints(<span class="string">"github"</span>), myapp)</span><br></pre></td></tr></table></figure>
<p>use API:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">req &lt;- GET(<span class="string">"https://api.github.com/users/jtleek/repos"</span>, </span><br><span class="line">           config(token = github_token))</span><br><span class="line">stop_for_status(req)</span><br><span class="line">output &lt;- content(req)</span><br><span class="line">jsondata &lt;- fromJSON(toJSON(output))</span><br><span class="line">subset(jsondata, name == <span class="string">"datasharing"</span>, select = c(created_at))</span><br></pre></td></tr></table></figure>
<p>the result is <code>2013-11-07T13:25:07Z</code>.</p>
</li>
<li><p>After install the package “sqldf”, download the file from the Internet, use browser or commands:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(sqldf)</span><br><span class="line">fileUrl &lt;- <span class="string">"https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06pid.csv"</span></span><br><span class="line">download.file(url=fileUrl,destfile=<span class="string">"getdata.csv"</span>, method=<span class="string">"curl"</span>)</span><br><span class="line">acs &lt;- read.csv(<span class="string">"getdata.csv"</span>)</span><br><span class="line">sqldf(<span class="string">"select pwgtp1 from acs where AGEP &lt; 50"</span>)</span><br></pre></td></tr></table></figure>
<p>so the answer is <code>sqldf(&quot;select pwgtp1 from acs where AGEP &lt; 50&quot;)</code>.</p>
</li>
<li><p>The same file, so use command:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqldf(<span class="string">"select distinct AGEP from acs"</span>)</span><br></pre></td></tr></table></figure>
<p>the answer is <code>sqldf(&quot;select distinct AGEP from acs&quot;)</code>.</p>
</li>
<li><p>Read the URL:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">char &lt;- url(<span class="string">"http://biostat.jhsph.edu/~jleek/contact.html"</span>)</span><br><span class="line">htmlCode &lt;- readLines(char)</span><br><span class="line">close(char)</span><br></pre></td></tr></table></figure>
<p>then find out the result:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nchar(htmlCode[<span class="number">10</span>])</span><br><span class="line">nchar(htmlCode[<span class="number">20</span>])</span><br><span class="line">nchar(htmlCode[<span class="number">30</span>])</span><br></pre></td></tr></table></figure>
<p>the result is <code>45,31,7</code>.</p>
</li>
<li><p>Try to combine the “download” and “read” function together use the command line:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data &lt;- read.fwf(file = <span class="string">"https://d396qusza40orc.cloudfront.net/getdata%2Fwksst8110.for"</span>,</span><br><span class="line">                skip = <span class="number">4</span>,</span><br><span class="line">                widths = c(<span class="number">12</span>, <span class="number">7</span>,<span class="number">4</span>, <span class="number">9</span>,<span class="number">4</span>, <span class="number">9</span>,<span class="number">4</span>, <span class="number">9</span>,<span class="number">4</span>))</span><br><span class="line">sum(data[, <span class="number">4</span>])</span><br></pre></td></tr></table></figure>
<p>the result is <code>32426.7</code>.</p>
</li>
</ol>
<p>A very useful blog: <a href="https://thoughtfulbloke.wordpress.com/2015/09/09/getting-and-cleaning-week-2/" target="_blank" rel="external">thoughtfulbloke aka David Hood</a></p>
<p>The END.</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/blog/2016/03/01/GCD-1/" itemprop="url">
                  Getting and Cleanning Data: Quiz 1
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-03-01T18:45:41+08:00" content="2016-03-01">
              2016-03-01
            </time>
          </span>

          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Quiz"><a href="#Quiz" class="headerlink" title="Quiz"></a>Quiz</h3><ol>
<li><p>The American Community Survey distributes downloadable data about United States communities. Download the 2006 microdata survey about housing for the state of Idaho using download.file() from here:</p>
<p><a href="https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06hid.csv" target="_blank" rel="external">https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06hid.csv</a></p>
<p>and load the data into R. The code book, describing the variable names is here:</p>
<p><a href="https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FPUMSDataDict06.pdf" target="_blank" rel="external">https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FPUMSDataDict06.pdf</a></p>
<p>How many properties are worth $1,000,000 or more?</p>
<ul>
<li>53</li>
<li>2076</li>
<li>31</li>
<li>159<br>​</li>
</ul>
</li>
<li><p>Use the data you loaded from Question 1. Consider the variable FES in the code book. Which of the “tidy data” principles does this variable violate?</p>
<ul>
<li>Tidy data has one observation per row.</li>
<li>Each variable in a tidy data set has been transformed to be interpretable.</li>
<li>Tidy data has one variable per column.</li>
<li>Each tidy data table contains information about only one type of observation.<br>​</li>
</ul>
</li>
<li><p>Download the Excel spreadsheet on Natural Gas Aquisition Program here:</p>
<p><a href="https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FDATA.gov_NGAP.xlsx" target="_blank" rel="external">https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FDATA.gov_NGAP.xlsx</a></p>
<p>Read rows 18-23 and columns 7-15 into R and assign the result to a variable called:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dat</span><br></pre></td></tr></table></figure>
<p>What is the value of:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sum(dat$Zip*dat$Ext,na.rm=<span class="literal">T</span>)</span><br></pre></td></tr></table></figure>
<p>(original data source: <a href="http://catalog.data.gov/dataset/natural-gas-acquisition-program" target="_blank" rel="external">http://catalog.data.gov/dataset/natural-gas-acquisition-program</a>)</p>
<ul>
<li>36534720</li>
<li>154339</li>
<li>NA</li>
<li>33544718<br>​</li>
</ul>
</li>
<li><p>Read the XML data on Baltimore restaurants from here:</p>
<p><a href="https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Frestaurants.xml" target="_blank" rel="external">https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Frestaurants.xml</a></p>
<p>How many restaurants have zipcode 21231?</p>
<ul>
<li>17</li>
<li>100</li>
<li>127</li>
<li>156<br>​</li>
</ul>
</li>
<li><p>The American Community Survey distributes downloadable data about United States communities. Download the 2006 microdata survey about housing for the state of Idaho using download.file() from here:</p>
<p><a href="https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06pid.csv" target="_blank" rel="external">https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06pid.csv</a></p>
<p>using the fread() command load the data into an R object</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DT</span><br></pre></td></tr></table></figure>
<p>The following are ways to calculate the average value of the variable</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pwgtp15</span><br></pre></td></tr></table></figure>
<p>broken down by sex. Using the data.table package, which will deliver the fastest user time?</p>
<ul>
<li>DT[,mean(pwgtp15),by=SEX]</li>
<li>mean(DT[DT$SEX==1,]$pwgtp15); mean(DT[DT$SEX==2,]$pwgtp15)</li>
<li>mean(DT$pwgtp15,by=DT$SEX)</li>
<li>sapply(split(DT$pwgtp15,DT$SEX),mean)</li>
<li>rowMeans(DT)[DT$SEX==1]; rowMeans(DT)[DT$SEX==2]</li>
<li>tapply(DT$pwgtp15,DT$SEX,mean)</li>
</ul>
</li>
</ol>
<h3 id="MY-solution"><a href="#MY-solution" class="headerlink" title="MY solution"></a>MY solution</h3><ol>
<li><p>Download the file from the Internet, use browser or commands:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fileUrl &lt;- <span class="string">"https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06hid.csv"</span></span><br><span class="line">download.file(url=fileUrl,destfile=<span class="string">"idaho_housing.csv"</span>, method=<span class="string">"curl"</span>)</span><br><span class="line">data &lt;- read.csv(idaho_housing.csv)</span><br><span class="line">head(data)</span><br></pre></td></tr></table></figure>
<p>Then check the code book, it says VAL with 24 represents any house more than $1,000,000. Following piece of code is trying to get count on house price &gt; $1,000,000 whose value is not NA:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">length(data$VAL[!is.na(data$VAL) &amp; data$VAL == <span class="number">24</span>])</span><br></pre></td></tr></table></figure>
<p>the result is <code>53</code>.</p>
</li>
<li><p>The answer is <code>Tidy data has one variable per column.</code></p>
</li>
<li><p>Download the file from the Internet, use browser or commands:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fileUrl &lt;- <span class="string">"https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FDATA.gov_NGAP.xlsx"</span></span><br><span class="line">download.file(fileUrl, destfile = <span class="string">"NGAP.xlsx"</span>, method = <span class="string">"curl"</span>)</span><br><span class="line">dateDownloaded &lt;- date()</span><br></pre></td></tr></table></figure>
<p>Then start the analysis process:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(xlsx)</span><br><span class="line">rowIndex &lt;- <span class="number">18</span>:<span class="number">23</span></span><br><span class="line">colIndex &lt;- <span class="number">7</span>:<span class="number">15</span></span><br><span class="line">dat &lt;- read.xlsx(file=<span class="string">"NGAP.xlsx"</span>,sheetIndex=<span class="number">1</span>,colIndex=colIndx,startRow=<span class="number">18</span>, endRow=<span class="number">23</span>, header=<span class="literal">TRUE</span>)</span><br><span class="line">head(dat)</span><br><span class="line">sum(dat$ZIP * dat$EXT, na.rm = <span class="literal">T</span>)</span><br></pre></td></tr></table></figure>
<p>the result is <code>36534720</code>.</p>
</li>
<li><p>Download the file from the Internet, use browser or commands:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># delete the "s" of "https://" first</span></span><br><span class="line"><span class="keyword">library</span>(XML)</span><br><span class="line">fileUrl &lt;- <span class="string">"http://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Frestaurants.xml"</span></span><br><span class="line">doc &lt;- xmlTreeParse(file = fileUrl, useInternal = <span class="literal">TRUE</span>)</span><br><span class="line">rootNode &lt;- xmlRoot(doc)</span><br><span class="line">xmlName(rootNode)</span><br><span class="line">zipcode &lt;- xpathSApply(rootNode,<span class="string">"//zipcode"</span>,xmlValue)</span><br><span class="line">length(zipcode[zipcode==<span class="number">21231</span>])</span><br></pre></td></tr></table></figure>
<p>the result is <code>127</code>.</p>
</li>
<li><p>Download the file from the Internet, use browser or commands:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fileUrl &lt;- <span class="string">"https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06pid.csv"</span></span><br><span class="line">download.file(url=fileUrl, destfile=<span class="string">"fsspid.csv"</span>, method=<span class="string">"curl"</span>)</span><br><span class="line">dateDownloaded &lt;- date()</span><br><span class="line"><span class="keyword">library</span>(data.table)</span><br><span class="line">DT &lt;- fread(input=<span class="string">"fsspid.csv"</span>, sep=<span class="string">","</span>)</span><br></pre></td></tr></table></figure>
<p>check the answer from very beginning.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system.time(DT[,mean(pwgtp15),by=SEX])</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># user  system elapsed </span></span><br><span class="line"><span class="comment"># 0.005   0.000   0.005</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system.time(mean(DT$pwgtp15,by=DT$SEX))</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># user  system elapsed </span></span><br><span class="line"><span class="comment"># 0       0       0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system.time(sapply(split(DT$pwgtp15,DT$SEX),mean))</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># user  system elapsed </span></span><br><span class="line"><span class="comment"># 0.001   0.000   0.001</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system.time(tapply(DT$pwgtp15,DT$SEX,mean))</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># user  system elapsed </span></span><br><span class="line"><span class="comment"># 0.002   0.000   0.002</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system.time(mean(DT[DT$SEX==<span class="number">1</span>,]$pwgtp15))</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># user  system elapsed </span></span><br><span class="line"><span class="comment"># 0.013   0.001   0.013</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system.time(mean(DT[DT$SEX==<span class="number">2</span>,]$pwgtp15))</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># user  system elapsed </span></span><br><span class="line"><span class="comment"># 0.016   0.000   0.018</span></span><br></pre></td></tr></table></figure>
<p>the answer is <code>sapply(split(DT$pwgtp15,DT$SEX),mean)</code>.</p>
</li>
</ol>
<p>The END.</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/blog/2016/03/01/World/" itemprop="url">
                  Hello,World!
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-03-01T16:05:48+08:00" content="2016-03-01">
              2016-03-01
            </time>
          </span>

          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Wellcome to Frank’s blog “Under the Wood”! This is my very first post. I’ll use this blog to record my study process and some life stories. Maybe boring or meaningless, but I will keep post everything.</p>
<h2 id="Chit-Chat"><a href="#Chit-Chat" class="headerlink" title="Chit Chat"></a>Chit Chat</h2><p>There are several tags of my blog, like “study” is for write down the process during my study, “Work” is for record the work experiences, “life” is for some little stories in my daily life, etc.</p>
<p>Blog is not only for post everything online, but for control my study and life in my Ph.D period.</p>
<p><code>Keep Running, Keep laughing</code></p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    

  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/blog/images/default_avatar.jpg"
               alt="Frank" />
          <p class="site-author-name" itemprop="name">Frank</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/blog/archives">
              <span class="site-state-item-count">5</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>
          
          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Frank</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  


  



  <script type="text/javascript" src="/blog/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/blog/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/blog/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/blog/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/blog/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/blog/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/blog/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/blog/js/src/motion.js?v=0.5.0"></script>



  
  

  

  


  <script type="text/javascript" src="/blog/js/src/bootstrap.js?v=0.5.0"></script>



  



  



  
  

  
  


</body>
</html>
